"use strict";
/*
 * @adonisjs/bouncer
 *
 * (c) Harminder Virk <virk@adonisjs.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.AuthorizationProfiler = void 0;
class AuthorizationProfiler {
    constructor(label, profiler, profilerPayload) {
        if (profiler) {
            this.profiler = profiler.create(label, profilerPayload);
        }
    }
    /**
     * Profiles a function
     */
    async profileFunction(actionName, data, fn, args) {
        if (!this.profiler) {
            return fn(...args);
        }
        const action = this.profiler.create(actionName, data);
        try {
            const response = await fn(...args);
            action.end();
            return response;
        }
        catch (error) {
            action.end({ error });
            throw error;
        }
    }
    end(payload) {
        if (this.profiler) {
            this.profiler.end(payload);
        }
        return payload;
    }
}
exports.AuthorizationProfiler = AuthorizationProfiler;
